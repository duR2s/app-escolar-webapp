<div class="navbar-sidebar-wrapper">

  <!-- ======================== -->
  <!-- SIDEBAR (DESKTOP)        -->
  <!-- ======================== -->
  <nav class="scoop-side-navbar" *ngIf="!isMobileView">
    <ul class="scoop-navbar-list">

      <!-- ITEM: REGISTRO (CON MAT-MENU) -->
      <li *ngIf="canSeeRegisterItem()" [matMenuTriggerFor]="registroMenu" class="scoop-navbar-item" style="cursor: pointer;">
        <span class="material-icons">person_add</span> <!-- O mat-icon si prefieres -->
        <span>Registro</span>
        <span class="material-icons" style="font-size: 16px; margin-left: auto;">arrow_drop_down</span>
      </li>

      <!-- ITEMS: REGULARES -->
      <li *ngIf="canSeeAdminItems()" routerLink="/administrador" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">admin_panel_settings</span>
        <span>Admins</span>
      </li>

      <li *ngIf="canSeeTeacherItems()" routerLink="/maestros" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">people</span>
        <span>Maestros</span>
      </li>

      <li *ngIf="canSeeStudentItems()" routerLink="/alumnos" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">school</span>
        <span>Alumnos</span>
      </li>

      <li *ngIf="canSeeStudentItems()" routerLink="/graficas" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">bar_chart</span>
        <span>Gráficas</span>
      </li>

      <li *ngIf="canSeeTeacherItems()" routerLink="/materias" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">library_books</span>
        <span>Materias</span>
      </li>

      <li *ngIf="canSeeTeacherItems()" routerLink="/eventos-academicos" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">event</span>
        <span>Eventos Académicos</span>
      </li>
    </ul>

    <!-- BOTÓN LOGOUT -->
    <button class="scoop-logout-btn" (click)="logout()">
      <span class="material-icons">logout</span>
      <span>Cerrar sesión</span>
    </button>
  </nav>

  <!-- ======================== -->
  <!-- TOP NAVBAR               -->
  <!-- ======================== -->
  <nav class="scoop-navbar">
    <!-- Botón Toggle Móvil -->
    <button class="dashboard-toggle-btn" *ngIf="isMobileView" (click)="toggleSidebar()" aria-label="Abrir menú">
      <span class="material-icons">menu_open</span>
    </button>

    <!-- Logo -->
    <span class="scoop-navbar-logo">BUAP</span>

    <!-- Iconos Derecha -->
    <div class="scoop-navbar-icons">
      <span class="material-icons navbar-icon" (click)="togglePalette()" style="cursor:pointer; margin-right: 15px;">palette</span>
      <div class="scoop-navbar-avatar" *ngIf="userInitial">{{ userInitial }}</div>
    </div>
  </nav>

  <!-- ======================== -->
  <!-- SIDEBAR (MOBILE)         -->
  <!-- ======================== -->
  <ng-container *ngIf="isMobileView">
    <!-- Overlay Oscuro -->
    <div class="mobile-sidebar-overlay" [ngClass]="{'mobile-open': mobileOpen}" (click)="closeSidebar()"></div>

    <!-- Menú Lateral Móvil -->
    <nav class="scoop-side-navbar" [ngClass]="{'mobile-open': mobileOpen}">
      <ul class="scoop-navbar-list">

        <!-- ITEM: REGISTRO (MÓVIL) -->
        <!-- Nota: En móvil a veces es mejor routerLink directo o expandir, pero mantengo tu mat-menu -->
        <li *ngIf="canSeeRegisterItem()" [matMenuTriggerFor]="registroMenu" class="scoop-navbar-item" style="cursor: pointer;">
            <span class="material-icons">person_add</span>
            <span>Registro</span>
            <span class="material-icons" style="font-size: 16px; margin-left: auto;">arrow_drop_down</span>
        </li>

        <li *ngIf="canSeeAdminItems()" routerLink="/administrador" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">admin_panel_settings</span>
          <span>Admins</span>
        </li>

        <li *ngIf="canSeeTeacherItems()" routerLink="/maestros" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">people</span>
          <span>Maestros</span>
        </li>

        <li *ngIf="canSeeStudentItems()" routerLink="/alumnos" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">school</span>
          <span>Alumnos</span>
        </li>

        <li *ngIf="canSeeStudentItems()" routerLink="/graficas" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">bar_chart</span>
          <span>Gráficas</span>
        </li>

        <li *ngIf="canSeeTeacherItems()" routerLink="/materias" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">library_books</span>
          <span>Materias</span>
        </li>

        <li *ngIf="canSeeTeacherItems()" routerLink="/eventos-academicos" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">event</span>
          <span>Eventos Académicos</span>
        </li>
      </ul>

      <button class="scoop-logout-btn" (click)="logout(); closeSidebar()">
        <span class="material-icons">logout</span>
        <span>Cerrar sesión</span>
      </button>
    </nav>
  </ng-container>

</div>

<!-- ======================== -->
<!-- MENÚ DESPLEGABLE (ANGULAR MATERIAL) -->
<!-- ======================== -->
<mat-menu #registroMenu="matMenu">
  <button mat-menu-item *ngIf="isAdmin()" routerLink="/registro/administrador">
    <mat-icon>admin_panel_settings</mat-icon>
    <span>Administrador</span>
  </button>
  <button mat-menu-item *ngIf="isAdmin() || isTeacher()" routerLink="/registro/maestros">
    <mat-icon>person</mat-icon>
    <span>Maestro</span>
  </button>
  <button mat-menu-item *ngIf="isAdmin() || isTeacher()" routerLink="/registro/alumnos">
    <mat-icon>school</mat-icon>
    <span>Alumno</span>
  </button>
  <button mat-menu-item *ngIf="isAdmin()" routerLink="/registro/materias">
    <mat-icon>library_books</mat-icon>
    <span>Materia</span>
  </button>
</mat-menu>
